{% extends "../layouts/app.html" %}

{% block title %} Tanggal Absen {% endblock title %}

{% block nav-menu-open-absensi %} menu-open {% endblock %}

{% block nav-active-absensi %} active {% endblock %}

{% block subnavactiveharian %} active  {% endblock %}

{% block content-header-page %}
<li class="breadcrumb-item"><a href="{% url 'kepegawaian:indexTanggalAbsen' %}">Tanggal Absen</a></li>
<li class="breadcrumb-item active">Absensi {{object.tanggal_absen}}</li>
{% endblock content-header-page %}

{% block content %}
<style> i.ihover{color: rgb(164, 44, 44);}i.ihover:hover{color: rgb(228, 79, 79);}i.dhover{color: rgb(22, 100, 62);} i.dhover:hover{color: rgb(56, 167, 102);}</style> 
<div class="row">
    <!-- Left col -->
<section class="col-lg-12 connectedSortable">

      <div class="card card-outline card-success">
        <div class="card-header">
        <h3 class="card-title">
            <i class="fas fa-list-alt mr-1"></i>
            Absensi Tanggal {{object.tanggal_absen}}
        </h3>
        <div class="card-tools">
            <ul class="nav nav-pills ml-auto">
              <li class="nav-item">
                <a class="nav-link active" title="Daftar Tanggal Absen" href="#data-absensi" data-toggle="tab"><i class="fas fa-ellipsis-v"></i></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" title="Tambah Pegawai" href="#tambah-absensi" data-toggle="tab"><i class="fas fa-plus"></i></a>
              </li>
            </ul>
          </div>
        </div><!-- /.card-header -->
        <div class="card-body">
            <div class="tab-content p-0">
                <!-- Morris chart - Sales -->
                <div class="tab-pane active" id="data-absensi">
                    <form id="lembagaform1" data-lembagas1-url="{% url 'kepegawaian:ajax_load_pegawais1' %}">
                        {% csrf_token %}
                        <input type="hidden" name="tanggal_absen" value="{{object.id_tanggal_absen}}"> 
                            <select name="lembaga" id="id_lembaga1" class="form-control" required>
                                <option value="">Pilih Lembaga</option>
                                {% for lembaga in lembaga_list%}
                                <option value="{{lembaga.id_lembaga}} {{object.tanggal_absen|date:'Y-m-j'}}">{{lembaga.nama_lembaga}}</option>
                                {% endfor %} 
                            </select>
                          <div class="app-table" id="id_lembaga_lama1">
                          </div>
                      </form> 
                </div>
                <div class="tab-pane" id="tambah-absensi">
                    <form action="{% url 'kepegawaian:addAbsensi'%}" method="POST" id="lembagaform" data-lembagas-url="{% url 'kepegawaian:ajax_load_pegawais' %}">
                        {% csrf_token %}
                        <input type="hidden" name="tanggal_absen" value="{{object.id_tanggal_absen}}"> 
                            <select name="lembaga" id="id_lembaga" class="form-control" required>
                                <option value="">Pilih Lembaga</option>
                                {% for lembaga in lembaga_list%}
                                <option value="{{lembaga.id_lembaga}}">{{lembaga.nama_lembaga}}</option>
                                {% endfor %} 
                            </select>
                          <div class="app-table" id="id_lembaga_lama">
                          </div>
                      </form>                      
                </div>   
            </div>
        </div><!-- /.card-body -->
      </div>
</div>
    </div>
    
      <!-- Detail Jabatan -->
</section>
    <!-- /.Left col -->
  </div>
{% endblock content %}

{% block script %}
<script>
    $("#id_lembaga1").change(function () {
    const url = $("#lembagaform1").attr("data-lembagas1-url");  // get the url of the `load_cities` view
    const lembaga = $(this).val();  // get the selected country ID from the HTML input

    $.ajax({                       // initialize an AJAX request
        url: url,                    // set the url of the request (= /persons/ajax/load-cities/ )
        data: {
            'lembaga': lembaga       // add the country id to the GET parameters
        },
        success: function (data) {   // `data` is the return of the `load_cities` view function
            $("#id_lembaga_lama1").html(data);  // replace the contents of the city input with the data that came from the server
        }
    });

});

$("#id_lembaga").change(function () {
    const url = $("#lembagaform").attr("data-lembagas-url");  // get the url of the `load_cities` view
    const lembaga = $(this).val();  // get the selected country ID from the HTML input

    $.ajax({                       // initialize an AJAX request
        url: url,                    // set the url of the request (= /persons/ajax/load-cities/ )
        data: {
            'lembaga': lembaga       // add the country id to the GET parameters
        },
        success: function (data) {   // `data` is the return of the `load_cities` view function
            $("#id_lembaga_lama").html(data);  // replace the contents of the city input with the data that came from the server
        }
    });

});
</script>
{% endblock script %}
