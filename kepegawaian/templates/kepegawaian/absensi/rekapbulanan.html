{% extends "../layouts/app.html" %}

{% block title %} Tanggal Absen {% endblock title %}

{% block nav-menu-open-absensi %} menu-open {% endblock %}

{% block nav-active-absensi %} active {% endblock %}

{% block subnavactiverekapbulanan %} active  {% endblock %}

{% block content-header-page %}
<li class="breadcrumb-item"><a href="{% url 'kepegawaian:indexRekapAbsensi' %}">Rekap Absensi Bulanan</a></li>
<li class="breadcrumb-item active"></li>
{% endblock content-header-page %}

{% block content %}
<style> i.ihover{color: rgb(164, 44, 44);}i.ihover:hover{color: rgb(228, 79, 79);}</style> 
<div class="row">
    <!-- Left col -->
    <section class="col-lg-12 connectedSortable">
      <!-- Custom tabs (Charts with tabs)-->
      <div class="card card-outline card-success">
        <div class="card-header">
          <h3 class="card-title">
            <i class="fas fa-list-alt mr-1"></i>
            Rekap Absensi Bulanan
          </h3>
          </div><!-- /.card-header -->
        <div class="card-body">
          <div class="tab-content p-0">
            <!-- Morris chart - Sales -->
                <div class="tab-pane active" id="data-tanggal-absen">
                    <form id="lembagaform" data-lembagas-url="{% url 'kepegawaian:ajax_load_pegawais_rekapbulanan' %}">
                        {% csrf_token %}
                            <select name="lembaga" id="id_lembaga" class="form-control" required>
                                <option value="">Pilih Lembaga</option>
                                {% for lembaga in object_list%}
                                <option value="{{lembaga.id_lembaga}} {{object.tanggal_absen|date:'Y-m-j'}}">{{lembaga.nama_lembaga}}</option>
                                {% endfor %} 
                            </select>
                          <div class="app-table" id="id_lembaga_lama">
                          </div>
                      </form>
                </div> 
          </div>
        </div><!-- /.card-body -->
      </div>
      </div>
      <!-- /.card -->
    </section>
    <!-- /.Left col -->
  </div>
{% endblock content %}

{% block script %}
<script>
    $("#id_lembaga").change(function () {
    const url = $("#lembagaform").attr("data-lembagas-url");  // get the url of the `load_cities` view
    const lembaga = $(this).val();  // get the selected country ID from the HTML input

    $.ajax({                       // initialize an AJAX request
        url: url,                    // set the url of the request (= /persons/ajax/load-cities/ )
        data: {
            'lembaga': lembaga       // add the country id to the GET parameters
        },
        success: function (data) {   // `data` is the return of the `load_cities` view function
            $("#id_lembaga_lama").html(data);  // replace the contents of the city input with the data that came from the server
        }
    });

});
</script>
{% endblock script %}